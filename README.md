# AutoPrint: Автоматическая печать текста из S3 (Windows)

Этот скрипт автоматически отслеживает S3 бакет на наличие текстовых файлов, преобразует их в изображения по шаблону и отправляет на печать на принтер Windows, используя GDI (Graphics Device Interface). Поддерживаются текстовые файлы (`.txt`).

---

## Установка

1. Убедитесь, что вы используете **Windows**.
2. Установите Python 3.10+.
3. Установите зависимости:

```bash
pip install -r requirements.txt
```

---

## Запуск

### Установка AWS CLI для Windows

1. Скачайте инсталлятор AWS CLI для Windows с официального сайта AWS или по ссылке: https://awscli.amazonaws.com/AWSCLIV2.msi

2. Запустите скачанный файл AWSCLIV2.msi и следуйте инструкциям мастера установки.

3. После установки откройте новое окно командной строки и проверьте установку командой:

```bash
aws --version
```

Дополнительная информация об установке AWS CLI для Windows доступна в [документации Yandex Cloud](https://yandex.cloud/ru/docs/storage/quickstart/quickstart-aws-cli#windows_1).

### Печать из Yandex Cloud S3 бакета

1. Настройте AWS CLI для работы с Yandex Cloud:

```bash
aws configure set aws_access_key_id YOUR_YANDEX_ACCESS_KEY_ID
aws configure set aws_secret_access_key YOUR_YANDEX_SECRET_ACCESS_KEY
aws configure set default.region ru-central1
aws configure set default.output json
```

2. Отредактируйте файл `silent_print_s3.py` и укажите имя вашего S3 бакета в Yandex Cloud в переменной `S3_BUCKET_NAME`.

3. Запустите скрипт:

```bash
python silent_print_s3.py
```

4. При запуске скрипт проверяет все существующие ненапечатанные текстовые файлы в бакете и отправляет их на печать. После этого переходит в режим мониторинга и каждую секунду проверяет наличие новых или изменённых файлов.

5. Для каждого текстового файла создаётся изображение на основе шаблона A5, которое отправляется на печать.

6. По умолчанию печать выполняется на формате A5, что автоматически настраивается в параметрах принтера.

7. Информация о напечатанных файлах сохраняется в файле `printed_files.txt`.

### Загрузка файлов в Yandex Cloud S3

Для загрузки текстовых файлов в бакет используйте AWS CLI с указанием endpoint-url:

```bash
aws --endpoint-url=https://storage.yandexcloud.net s3 cp ./путь/к/файлу.txt s3://имя-бакета/имя-файла.txt
```

Например, для загрузки текстового файла:

```bash
aws --endpoint-url=https://storage.yandexcloud.net s3 cp ./message.txt s3://wikilect-ecom-expo-may-2025/message.txt
```

Чтобы остановить любой из скриптов — нажмите `Ctrl + C`.

---

## Как включить цветную печать по умолчанию (Canon LBP631Cw)

### Через панель управления Windows:

1. Откройте **Панель управления** → **Устройства и принтеры**
2. Найдите **Canon LBP631Cw**, нажмите правой кнопкой мыши → **Настройки печати**
3. Перейдите на вкладку **Цвет/Черно-белый** или аналогичную, и выберите **Цвет**
4. Нажмите **OK**/Применить

### Через свойства драйвера:

1. Откройте **Свойства принтера** → вкладка **Дополнительно**
2. Нажмите **Параметры печати по умолчанию**
3. Установите цветной режим
4. Сохраните изменения


